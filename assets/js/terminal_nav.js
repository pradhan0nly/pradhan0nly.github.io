!function(){function e(){var e=document.getElementById("terminal-pages-data");if(e)try{(L=JSON.parse(e.textContent||"[]")).forEach(function(e){E[e.key]=e,e.title&&(E[e.title.toLowerCase()]=e),e.terminal_only&&(w[e.key]=e)})}catch(e){L=[]}}function t(e){m=e,localStorage.setItem(d,m?"on":"off"),document.body.classList.toggle("terminal-enabled",m),h&&h.setAttribute("aria-hidden",m?"false":"true"),g.forEach(function(e){e.setAttribute("aria-pressed",m?"true":"false")}),m&&a()}function n(e){if(f){var t=document.createElement("div");t.className="terminal-line",t.innerHTML=e,f.appendChild(t),f.scrollTop=f.scrollHeight}}function a(){!f||f.childNodes.length>0||(n('anish@site:~$ <span class="terminal-inline">boot</span>'),n("status: experimental terminal enabled"),n("modules: nav, theme"),n('type <span class="terminal-inline">help</span> for commands'),p&&p.focus())}function i(e){localStorage.setItem("theme",e),location.reload()}function o(){var e=L.filter(function(e){return e.nav}).map(function(e){return e.key});return j&&Object.keys(w).forEach(function(t){e.push(t)}),e}function r(e){var t=E[e];return!!t&&(location.href=t.permalink,!0)}function l(e){var t=(e||"").trim();if(t){var a=t.split(/\s+/),l=a[0].toLowerCase(),s=a.slice(1).join(" ").toLowerCase();if("help"!==l)if("clear"!==l)if("ls"!==l){if("open"===l||"go"===l)return s?void(r(s)||n("unknown page: "+s)):void n("usage: "+l+" <page>");if(E[l])r(l);else{if(w[l])return j?void r(l):void n("access denied");if("scan"!==l){if("decode"===l){if(!s)return void n("usage: decode <order>");var c=s.split(/[,\s]+/).filter(Boolean),u=s.replace(/\s+/g,""),d=I.order.map(function(e){return e[0]}).join("");return c.length===I.order.length&&c.every(function(e,t){return e===I.order[t]})||u.length===d.length&&u===d?void n("decoded: "+I.blocks.map(function(e){return e.value}).join("").toLowerCase()):void n("decode failed")}if("unlock"===l)return s?s!==I.passphrase?void n("access denied"):(j=!0,sessionStorage.setItem("terminalUnlocked","true"),n("access granted"),void n("hidden: "+Object.keys(w).join(" "))):void n("usage: unlock <passphrase>");if("theme"===l)return"light"===s||"dark"===s||"system"===s?(n("theme "+s),void i(s)):void n("theme requires: light | dark | system");if("whoami"!==l)if("time"!==l)if("echo"!==l)if("history"!==l)n("unknown command: "+t);else{var m=y.slice(-5);m.length?n(m.join(" | ")):n("history: empty")}else n(a.slice(1).join(" "));else n((new Date).toLocaleString());else n("anish pradhan")}else n("scan: "+I.hint)}}else n("pages: "+o().join(" "));else f&&(f.innerHTML="");else n("commands: help, clear, ls, open <page>, go <page>, theme light|dark|system, whoami, time, echo, history, scan, decode <order>, unlock <passphrase>")}}function s(e){var t=e.toLowerCase(),n=["help","clear","ls","open","go","theme","whoami","time","echo","history","scan","decode","unlock"].concat(Object.keys(E));return j&&(n=n.concat(Object.keys(w))),n.filter(function(e){return 0===e.indexOf(t)})}function c(e){if(b.base!==e&&(b.base=e,b.matches=s(e),b.index=0),1===b.matches.length)return b.matches[0]+" ";if(b.matches.length>1){var t=b.matches[b.index%b.matches.length];return b.index+=1,t}return e}function u(){v&&(v.innerHTML="",L.filter(function(e){return e.nav}).forEach(function(e){var t=document.createElement("button");t.className="terminal-btn",t.setAttribute("data-cmd",e.key),t.textContent="[ "+e.title+" ]",t.addEventListener("click",function(){l(e.key)}),v.appendChild(t)}))}var d="terminalNav",m="on"===localStorage.getItem(d),h=null,f=null,p=null,v=null,g=[],y=[],k=-1,b={base:"",matches:[],index:0},L=[],E={},w={},j="true"===sessionStorage.getItem("terminalUnlocked"),I={blocks:[{key:"cv",value:"SIG"},{key:"about",value:"NAL"},{key:"hobbies",value:"-"},{key:"publications",value:"VAULT"}],order:["cv","about","hobbies","publications"],hint:"sort nav titles by length (short to long) then decode using their first letters",passphrase:"signal-vault"};document.addEventListener("DOMContentLoaded",function(){h=document.getElementById("terminal-nav"),f=document.getElementById("terminal-output"),p=document.getElementById("terminal-input"),v=document.getElementById("terminal-links"),g=Array.prototype.slice.call(document.querySelectorAll(".terminal-toggle")),e(),u(),document.addEventListener("click",function(e){e.target.closest(".terminal-toggle")&&t(!m)}),p&&p.addEventListener("keydown",function(e){if("Enter"===e.key){var t=p.value;return n('<span class="terminal-inline">$</span> '+t),y.push(t),k=y.length,l(t),p.value="",void(b.base="")}"ArrowUp"===e.key&&(k>0&&(k-=1),p.value=y[k]||"",e.preventDefault()),"ArrowDown"===e.key&&(k<y.length-1?k+=1:k=y.length,p.value=y[k]||"",e.preventDefault()),"Tab"===e.key&&(e.preventDefault(),p.value=c(p.value.trim()))}),document.addEventListener("keydown",function(e){"`"===e.key&&t(!m)}),t(m)})}();